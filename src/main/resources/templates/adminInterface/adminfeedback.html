<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin - User Feedbacks</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
</head>
<body>

<div class="container mt-5">
    <h2 class="text-center mb-4">ðŸ“¬ User Feedback Management</h2>

    <div th:if="${feedbacks != null and feedbacks.size() > 0}">
        <table class="table table-hover table-bordered">
            <thead class="table-dark">
            <tr>
                <th>#</th>
                <th>Email</th>
                <th>Message Preview</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="feedback, iterStat : ${feedbacks}">
                <td th:text="${iterStat.count}"></td>
                <td th:text="${feedback.email}"></td>
                <td th:text="${#strings.abbreviate(feedback.message, 40)}"></td>
                <td>
                    <button class="btn btn-sm btn-info" data-bs-toggle="modal"
                            th:data-bs-target="'#readModal-' + ${feedback.id}">Read
                    </button>
                    <a th:href="@{'/admin/feedback/delete/' + ${feedback.id}}" 
                       class="btn btn-sm btn-danger"
                       onclick="return confirm('Are you sure you want to delete this feedback?');">
                        Delete
                    </a>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
    <div th:if="${feedbacks == null or feedbacks.size() == 0}" class="alert alert-warning text-center">
        No feedbacks available.
    </div>
</div>

<!-- Modal for Reading Feedback -->
<div th:each="feedback : ${feedbacks}">
    <div class="modal fade" th:id="'readModal-' + ${feedback.id}" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">ðŸ“¨ Feedback from <span th:text="${feedback.email}"></span></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p th:text="${feedback.message}"></p>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Bootstrap JS Bundle -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
